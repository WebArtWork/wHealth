import{e as F}from"./chunk-WDW6KDBE.js";import{K as s,L as u,M as f,R as _,Sa as w,Wa as y,X as v,bb as g,f as l,hb as b,i as o,ib as C,ob as S,r as d,s as p,vb as k,xb as T}from"./chunk-STQM5VJK.js";var P={formId:"healthtreatment",title:"Healthtreatment",components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill healthtreatment title"},{name:"Label",value:"Title"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill healthtreatment description"},{name:"Label",value:"Description"}]},{name:"Text",key:"recommendedMedication",fields:[{name:"Placeholder",value:"Fill recommended medication"},{name:"Label",value:"Recommended medication"}]},{name:"Text",key:"duration",fields:[{name:"Placeholder",value:"Fill duration"},{name:"Label",value:"Duration"}]},{name:"Text",key:"precautions",fields:[{name:"Placeholder",value:"Fill precautions"},{name:"Label",value:"Precautions"}]},{name:"Text",key:"patientAdvised",fields:[{name:"Placeholder",value:"Fill patient advised"},{name:"Label",value:"Patient advised"}]}]};var M=(()=>{class a extends C{constructor(){super({name:"healthtreatment"})}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var h=(()=>{class a{constructor(e,t,i,n,m,I){this._translate=e,this._healthtreatmentService=t,this._alert=i,this._form=n,this._core=m,this._router=I,this.patient_id=this._router.url.includes("treatment/")?this._router.url.replace("/treatment/",""):"",this.columns=["name","description","recommendedMedication","duration","precautions","patientAdvised"],this.form=this._form.getForm("healthtreatment",P),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._healthtreatmentService.setPerPage.bind(this._healthtreatmentService),allDocs:!1,create:()=>{this._form.modal(this.form,{label:"Create",click:(r,c)=>l(this,null,function*(){c(),this._preCreate(r),yield o(this._healthtreatmentService.create(r)),this.setRows()})})},update:r=>{this._form.modal(this.form,[],r).then(c=>{this._core.copy(c,r),this._healthtreatmentService.update(r)})},delete:r=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this healthtreatment?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>l(this,null,function*(){yield o(this._healthtreatmentService.delete(r)),this.setRows()})}]})},buttons:[{icon:"assignment",hrefFunc:r=>"/records/"+r.patient+"/treatment/"+r._id},{icon:"cloud_download",click:r=>{this._form.modalUnique("healthtreatment","url",r)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this._page=1,this.setRows()}setRows(e=this._page){this._page=e,this._core.afterWhile(this,()=>{this._healthtreatmentService.get({page:e,query:this._query()}).subscribe(t=>{this.rows.splice(0,this.rows.length),this.rows.push(...t)})},250)}_bulkManagement(e=!0){return()=>{this._form.modalDocs(e?[]:this.rows).then(t=>l(this,null,function*(){if(e)for(let i of t)this._preCreate(i),yield o(this._healthtreatmentService.create(i));else{for(let i of this.rows)t.find(n=>n._id===i._id)||(yield o(this._healthtreatmentService.delete(i)));for(let i of t){let n=this.rows.find(m=>m._id===i._id);n?(this._core.copy(i,n),yield o(this._healthtreatmentService.update(n))):(this._preCreate(i),yield o(this._healthtreatmentService.create(i)))}}this.setRows()}))}}_preCreate(e){delete e.__created,this.patient_id&&(e.patient=this.patient_id)}_query(){let e="";return this.patient_id&&(e+=(e?"&":"")+"patient="+this.patient_id),e}static{this.\u0275fac=function(t){return new(t||a)(s(S),s(M),s(b),s(T),s(g),s(w))}}static{this.\u0275cmp=u({type:a,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Treatment",3,"columns","config","rows"]],template:function(t,i){t&1&&v(0,"wtable",0),t&2&&_("columns",i.columns)("config",i.config)("rows",i.rows)},dependencies:[k],encapsulation:2})}}return a})();var R=[{path:"",component:h},{path:":patient_id",component:h}],J=(()=>{class a{static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275mod=f({type:a})}static{this.\u0275inj=p({imports:[y.forChild(R),F]})}}return a})();export{J as TreatmentModule};
