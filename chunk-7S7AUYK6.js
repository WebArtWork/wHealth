import{a as M}from"./chunk-NQLGH4CP.js";import{a as F}from"./chunk-AQFVT7JL.js";import{e as b}from"./chunk-WDW6KDBE.js";import{K as n,L as u,M as d,R as p,Sa as _,Wa as w,X as f,bb as v,f as a,hb as g,i as c,ob as C,s as m,vb as y,xb as S}from"./chunk-STQM5VJK.js";var k=(()=>{class r{constructor(s,t,i,o,l,j){this._translate=s,this._healthclinicService=t,this._alert=i,this._form=o,this._core=l,this._router=j,this.record_id=this._router.url.includes("clinics/")?this._router.url.replace("/clinics/",""):"",this.columns=["name","description","phone","email","website","workingHours","licenseNumber","specialties","clinicType"],this.form=this._form.getForm("healthclinic",M),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._healthclinicService.setPerPage.bind(this._healthclinicService),allDocs:!1,create:()=>{this._form.modal(this.form,{label:"Create",click:(e,h)=>a(this,null,function*(){h(),this._preCreate(e),yield c(this._healthclinicService.create(e)),this.setRows()})})},update:e=>{this._form.modal(this.form,[],e).then(h=>{this._core.copy(h,e),this._healthclinicService.update(e)})},delete:e=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this healthclinic?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>a(this,null,function*(){yield c(this._healthclinicService.delete(e)),this.setRows()})}]})},buttons:[{icon:"assignment",hrefFunc:e=>"/records/clinics/"+e._id},{icon:"place",hrefFunc:e=>"/places/clinics/"+e._id},{icon:"health_and_safety",hrefFunc:e=>"/doctors/"+e._id},{icon:"comment",hrefFunc:e=>"/comments/"+e._id},{icon:"cloud_download",click:e=>{this._form.modalUnique("healthclinic","url",e)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this._page=1,this.setRows()}setRows(s=this._page){this._page=s,this._core.afterWhile(this,()=>{this._healthclinicService.get({page:s,query:this._query()}).subscribe(t=>{this.rows.splice(0,this.rows.length),this.rows.push(...t)})},250)}_bulkManagement(s=!0){return()=>{this._form.modalDocs(s?[]:this.rows).then(t=>a(this,null,function*(){if(s)for(let i of t)this._preCreate(i),yield c(this._healthclinicService.create(i));else{for(let i of this.rows)t.find(o=>o._id===i._id)||(yield c(this._healthclinicService.delete(i)));for(let i of t){let o=this.rows.find(l=>l._id===i._id);o?(this._core.copy(i,o),yield c(this._healthclinicService.update(o))):(this._preCreate(i),yield c(this._healthclinicService.create(i)))}}this.setRows()}))}}_preCreate(s){delete s.__created}_query(){return""}static{this.\u0275fac=function(t){return new(t||r)(n(C),n(F),n(g),n(S),n(v),n(_))}}static{this.\u0275cmp=u({type:r,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Clinics",3,"columns","config","rows"]],template:function(t,i){t&1&&f(0,"wtable",0),t&2&&p("columns",i.columns)("config",i.config)("rows",i.rows)},dependencies:[y],encapsulation:2})}}return r})();var q=[{path:"",component:k}],z=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275mod=d({type:r})}static{this.\u0275inj=m({imports:[w.forChild(q),b]})}}return r})();export{z as ClinicsModule};
