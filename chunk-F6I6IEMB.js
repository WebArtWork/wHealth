import{a as j}from"./chunk-CHZV4QHW.js";import{e as k}from"./chunk-WDW6KDBE.js";import{K as r,L as p,M as _,Qa as v,R as f,Sa as y,Wa as w,X as u,bb as g,f as m,hb as C,i as a,ob as b,s as d,vb as S,xb as M}from"./chunk-STQM5VJK.js";var I={formId:"healthcomment",title:"Healthcomment",components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill healthcomment title"},{name:"Label",value:"Title"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill healthcomment description"},{name:"Label",value:"Description"}]}]};var n=(()=>{class s{constructor(t,i,e,c,h,R,F){this._translate=t,this._healthcommentService=i,this._alert=e,this._form=c,this._core=h,this._router=R,this._route=F,this.clinic_id=this._router.url.includes("comments/")?this._router.url.replace("/comments/",""):"",this.columns=["name","description"],this.form=this._form.getForm("healthcomment",I),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._healthcommentService.setPerPage.bind(this._healthcommentService),allDocs:!1,create:()=>{this._form.modal(this.form,{label:"Create",click:(o,l)=>m(this,null,function*(){l(),this._preCreate(o),yield a(this._healthcommentService.create(o)),this.setRows()})})},update:o=>{this._form.modal(this.form,[],o).then(l=>{this._core.copy(l,o),this._healthcommentService.update(o)})},delete:o=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this healthcomment?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>m(this,null,function*(){yield a(this._healthcommentService.delete(o)),this.setRows()})}]})},buttons:[{icon:"cloud_download",click:o=>{this._form.modalUnique("healthcomment","url",o)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this.doctor_id="",this.pharmacy_id="",this.place_id="",this._page=1,this.setRows(),this._route.paramMap.subscribe(o=>{this.doctor_id=o.get("doctor_id")||"",this.pharmacy_id=o.get("pharmacy_id")||"",this.place_id=o.get("place_id")||""})}setRows(t=this._page){this._page=t,this._core.afterWhile(this,()=>{this._healthcommentService.get({page:t,query:this._query()}).subscribe(i=>{this.rows.splice(0,this.rows.length),this.rows.push(...i)})},250)}_bulkManagement(t=!0){return()=>{this._form.modalDocs(t?[]:this.rows).then(i=>m(this,null,function*(){if(t)for(let e of i)this._preCreate(e),yield a(this._healthcommentService.create(e));else{for(let e of this.rows)i.find(c=>c._id===e._id)||(yield a(this._healthcommentService.delete(e)));for(let e of i){let c=this.rows.find(h=>h._id===e._id);c?(this._core.copy(e,c),yield a(this._healthcommentService.update(c))):(this._preCreate(e),yield a(this._healthcommentService.create(e)))}}this.setRows()}))}}_preCreate(t){delete t.__created,this.clinic_id&&(t.clinic=this.clinic_id),this.doctor_id&&(t.doctor=this.doctor_id),this.pharmacy_id&&(t.pharmacy=this.pharmacy_id),this.place_id&&(t.place=this.place_id)}_query(){let t="";return this.clinic_id&&(t+=(t?"&":"")+"clinic="+this.clinic_id),this.doctor_id&&(t+=(t?"&":"")+"doctor="+this.doctor_id),this.pharmacy_id&&(t+=(t?"&":"")+"pharmacy="+this.pharmacy_id),this.place_id&&(t+=(t?"&":"")+"place="+this.place_id),t}static{this.\u0275fac=function(i){return new(i||s)(r(b),r(j),r(C),r(M),r(g),r(y),r(v))}}static{this.\u0275cmp=p({type:s,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Comments",3,"columns","config","rows"]],template:function(i,e){i&1&&u(0,"wtable",0),i&2&&f("columns",e.columns)("config",e.config)("rows",e.rows)},dependencies:[S],encapsulation:2})}}return s})();var q=[{path:"",component:n},{path:":clinic_id",component:n},{path:":clinic_id/doctors/:doctor_id",component:n},{path:":clinic_id/pharmacies/:pharmacy_id",component:n},{path:":clinic_id/places/:place_id",component:n}],G=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=_({type:s})}static{this.\u0275inj=d({imports:[w.forChild(q),k]})}}return s})();export{G as CommentsModule};
