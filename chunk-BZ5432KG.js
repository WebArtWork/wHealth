import{a as F}from"./chunk-LFHVAGLD.js";import{a as L}from"./chunk-L5QHBTWI.js";import{a as D}from"./chunk-FWUV377N.js";import{e as P}from"./chunk-WDW6KDBE.js";import{K as a,L as _,M as g,R as k,Wa as y,X as w,bb as S,f as h,hb as b,i as l,ib as C,ob as I,r as d,s as v,vb as j,xb as M}from"./chunk-STQM5VJK.js";var c={formId:"healthlink",title:"Healthlink",components:[{name:"Select",key:"drug",focused:!0,fields:[{name:"Placeholder",value:"Choose drug"},{name:"Label",value:"Title"},{name:"Items",value:[]}]},{name:"Select",key:"place",fields:[{name:"Placeholder",value:"Choose place"},{name:"Label",value:"Description"},{name:"Items",value:[]}]},{name:"Select",key:"pharmacy",fields:[{name:"Placeholder",value:"Choose pharmacy"},{name:"Label",value:"Description"},{name:"Items",value:[]}]}]};var x=(()=>{class o extends C{constructor(){super({name:"healthlink"})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=d({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var H=(()=>{class o{constructor(r,t,i,n,m,p,f,u){this._translate=r,this._healthlinkService=t,this._alert=i,this._form=n,this._core=m,this._healthdrugService=p,this._healthplaceService=f,this._healthpharmacyService=u,this.columns=["place","drug","pharmacy"],this.form=this._form.getForm("healthlink",c),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._healthlinkService.setPerPage.bind(this._healthlinkService),allDocs:!1,create:()=>{this._form.modal(this.form,{label:"Create",click:(e,s)=>h(this,null,function*(){s(),this._preCreate(e),yield l(this._healthlinkService.create(e)),this.setRows()})})},update:e=>{this._form.modal(this.form,[],e).then(s=>{this._core.copy(s,e),this._healthlinkService.update(e)})},delete:e=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this healthlink?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>h(this,null,function*(){yield l(this._healthlinkService.delete(e)),this.setRows()})}]})},headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this._page=1,this._healthdrugService.get().subscribe(e=>{let s=c.components[0].fields[2].value;s.splice(0,s.length),s.push(...e),console.log(e)}),this._healthplaceService.get().subscribe(e=>{let s=c.components[1].fields[2].value;s.splice(0,s.length),s.push(...e),console.log(e)}),this._healthpharmacyService.get().subscribe(e=>{let s=c.components[2].fields[2].value;s.splice(0,s.length),s.push(...e),console.log(e)}),console.log(p),console.log(f),console.log(u),this.setRows()}setRows(r=this._page){this._page=r,this._core.afterWhile(this,()=>{this._healthlinkService.get({page:r}).subscribe(t=>{this.rows.splice(0,this.rows.length),this.rows.push(...t)})},250)}_bulkManagement(r=!0){return()=>{this._form.modalDocs(r?[]:this.rows).then(t=>h(this,null,function*(){if(r)for(let i of t)this._preCreate(i),yield l(this._healthlinkService.create(i));else{for(let i of this.rows)t.find(n=>n._id===i._id)||(yield l(this._healthlinkService.delete(i)));for(let i of t){let n=this.rows.find(m=>m._id===i._id);n?(this._core.copy(i,n),yield l(this._healthlinkService.update(n))):(this._preCreate(i),yield l(this._healthlinkService.create(i)))}}this.setRows()}))}}_preCreate(r){delete r.__created}static{this.\u0275fac=function(t){return new(t||o)(a(I),a(x),a(b),a(M),a(S),a(F),a(L),a(D))}}static{this.\u0275cmp=_({type:o,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Links",3,"columns","config","rows"]],template:function(t,i){t&1&&w(0,"wtable",0),t&2&&k("columns",i.columns)("config",i.config)("rows",i.rows)},dependencies:[j],encapsulation:2})}}return o})();var N=[{path:"",component:H}],$=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=g({type:o})}static{this.\u0275inj=v({imports:[y.forChild(N),P]})}}return o})();export{$ as LinksModule};
