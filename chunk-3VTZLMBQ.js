import{a as D,b as j}from"./chunk-SWJVH2XJ.js";import{e as M}from"./chunk-WDW6KDBE.js";import{K as n,L as p,M as u,R as _,Sa as w,Wa as v,X as f,bb as g,f as a,hb as y,i as c,ob as C,s as m,vb as S,xb as b}from"./chunk-STQM5VJK.js";var l=(()=>{class r{constructor(t,i,e,s,h,k){this._translate=t,this._healthdoctorService=i,this._alert=e,this._form=s,this._core=h,this._router=k,this.clinic_id=this._router.url.includes("doctors/")?this._router.url.replace("/doctors/",""):"",this.columns=["name","description","phone","specialty","experienceYears","consultationFee"],this.form=this._form.getForm("healthdoctor",D),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._healthdoctorService.setPerPage.bind(this._healthdoctorService),allDocs:!1,create:this._router.url.includes("doctors/")?()=>{this._form.modal(this.form,{label:"Create",click:(o,d)=>a(this,null,function*(){d(),this._preCreate(o),yield c(this._healthdoctorService.create(o)),this.setRows()})})}:null,update:o=>{this._form.modal(this.form,[],o).then(d=>{this._core.copy(d,o),this._healthdoctorService.update(o)})},delete:o=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this healthdoctor?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>a(this,null,function*(){yield c(this._healthdoctorService.delete(o)),this.setRows()})}]})},buttons:[{icon:"comment",hrefFunc:o=>"/comments/"+o.clinic+"/doctors/"+o._id},{icon:"cloud_download",click:o=>{this._form.modalUnique("healthdoctor","url",o)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this._page=1,this.setRows()}setRows(t=this._page){this._page=t,this._core.afterWhile(this,()=>{this._healthdoctorService.get({page:t,query:this._query()}).subscribe(i=>{this.rows.splice(0,this.rows.length),this.rows.push(...i)})},250)}_bulkManagement(t=!0){return()=>{this._form.modalDocs(t?[]:this.rows).then(i=>a(this,null,function*(){if(t)for(let e of i)this._preCreate(e),yield c(this._healthdoctorService.create(e));else{for(let e of this.rows)i.find(s=>s._id===e._id)||(yield c(this._healthdoctorService.delete(e)));for(let e of i){let s=this.rows.find(h=>h._id===e._id);s?(this._core.copy(e,s),yield c(this._healthdoctorService.update(s))):(this._preCreate(e),yield c(this._healthdoctorService.create(e)))}}this.setRows()}))}}_preCreate(t){delete t.__created,t.__created=!1,this.clinic_id&&(t.clinic=this.clinic_id)}_query(){let t="";return this.clinic_id&&(t+=(t?"&":"")+"clinic="+this.clinic_id),t}static{this.\u0275fac=function(i){return new(i||r)(n(C),n(j),n(y),n(b),n(g),n(w))}}static{this.\u0275cmp=p({type:r,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Doctors",3,"columns","config","rows"]],template:function(i,e){i&1&&f(0,"wtable",0),i&2&&_("columns",e.columns)("config",e.config)("rows",e.rows)},dependencies:[S],encapsulation:2})}}return r})();var R=[{path:"",component:l},{path:":clinic_id",component:l},{path:":patient_id",component:l}],z=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=u({type:r})}static{this.\u0275inj=m({imports:[v.forChild(R),M]})}}return r})();export{z as DoctorsModule};
