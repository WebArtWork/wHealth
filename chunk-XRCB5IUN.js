import{a as A,b as x}from"./chunk-62X7VECZ.js";import{e as P}from"./chunk-WDW6KDBE.js";import{K as n,L as w,M as b,Qa as T,R as S,Sa as R,Wa as k,X as F,bb as M,f as g,hb as j,i as h,ob as I,s as C,vb as q,xb as D}from"./chunk-STQM5VJK.js";var r=(()=>{class o{constructor(t,s,i,d,v,N,H){this._translate=t,this._healthrecordService=s,this._alert=i,this._form=d,this._core=v,this._router=N,this._route=H,this.columns=["name","description","diagnosis","allergy","result","treatmentType"],this.form=this._form.getForm("healthrecord",A),this._previousSelectedType=void 0,this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._healthrecordService.setPerPage.bind(this._healthrecordService),allDocs:!1,create:this._router.url.includes("records/")?()=>{let e={name:"",description:"",diagnosis:"",result:"",treatmentType:"",allergy:""},f=()=>{e.name="",e.description="",e.diagnosis="",e.result="",e.treatmentType="",e.allergy="";let c=this._form.getComponent(this.form,"name"),a=this._form.getComponent(this.form,"description"),l=this._form.getComponent(this.form,"diagnosis"),m=this._form.getComponent(this.form,"result"),_=this._form.getComponent(this.form,"treatmentType"),p=this._form.getComponent(this.form,"allergy");c.hidden=!0,a.hidden=!0,l.hidden=!0,m.hidden=!0,_.hidden=!0,p.hidden=!0};this._form.modal(this.form,{label:"Create",click:(c,a)=>g(this,null,function*(){a(),this._preCreate(c),yield h(this._healthrecordService.create(c)),this.setRows(),f()})},e,c=>{let a=c.type,l=this._form.getComponent(this.form,"name"),m=this._form.getComponent(this.form,"description"),_=this._form.getComponent(this.form,"diagnosis"),p=this._form.getComponent(this.form,"result"),u=this._form.getComponent(this.form,"treatmentType"),y=this._form.getComponent(this.form,"allergy");switch(a!==this._previousSelectedType&&(f(),this._previousSelectedType=a),a){case"Symptom":l.hidden=!1,m.hidden=!1,_.hidden=!0,p.hidden=!0,u.hidden=!0,y.hidden=!0;break;case"Analysis":l.hidden=!1,m.hidden=!1,_.hidden=!1,p.hidden=!1,u.hidden=!0,y.hidden=!0;break;case"Disease":l.hidden=!1,m.hidden=!1,_.hidden=!1,p.hidden=!1,u.hidden=!1,y.hidden=!1;break;case"Treatment":l.hidden=!1,m.hidden=!1,_.hidden=!0,p.hidden=!1,y.hidden=!0,u.hidden=!1;break}})}:null,update:e=>{this._form.modal(this.form,[],e).then(f=>{this._core.copy(f,e),this._healthrecordService.update(e)})},delete:e=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this healthrecord?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>g(this,null,function*(){yield h(this._healthrecordService.delete(e)),this.setRows()})}]})},buttons:[{icon:"cloud_download",click:e=>{this._form.modalUnique("healthrecord","url",e)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this.patient_id="",this.disease_id="",this.treatment_id="",this.doctor_id="",this.symptom_id="",this.analysis_id="",this.clinic_id="",this._page=1,this._route.paramMap.subscribe(e=>{this.patient_id=e.get("patient_id")||"",this.disease_id=e.get("disease_id")||"",this.treatment_id=e.get("treatment_id")||"",this.doctor_id=e.get("doctor_id")||"",this.symptom_id=e.get("symptom_id")||"",this.analysis_id=e.get("analysis_id")||"",this.clinic_id=e.get("clinic_id")||""}),this.setRows(),console.log(this.patient_id)}setRows(t=this._page){this._page=t,this._core.afterWhile(this,()=>{this._healthrecordService.get({page:t,query:this._query()}).subscribe(s=>{this.rows.splice(0,this.rows.length),this.rows.push(...s)})},250)}_bulkManagement(t=!0){return()=>{this._form.modalDocs(t?[]:this.rows).then(s=>g(this,null,function*(){if(t)for(let i of s)this._preCreate(i),yield h(this._healthrecordService.create(i));else{for(let i of this.rows)s.find(d=>d._id===i._id)||(yield h(this._healthrecordService.delete(i)));for(let i of s){let d=this.rows.find(v=>v._id===i._id);d?(this._core.copy(i,d),yield h(this._healthrecordService.update(d))):(this._preCreate(i),yield h(this._healthrecordService.create(i)))}}this.setRows()}))}}_preCreate(t){t.__created=!1,this.patient_id&&(t.patient=this.patient_id),this.disease_id&&(t.disease=this.disease_id),this.treatment_id&&(t.treatment=this.treatment_id),this.doctor_id&&(t.doctor=this.doctor_id),this.symptom_id&&(t.symptom=this.symptom_id),this.analysis_id&&(t.analysis=this.analysis_id),this.clinic_id&&(t.clinic=this.clinic_id)}_query(){let t="";return this.patient_id&&(t+=(t?"&":"")+"patient="+this.patient_id),this.disease_id&&(t+=(t?"&":"")+"disease="+this.disease_id),this.treatment_id&&(t+=(t?"&":"")+"treatment="+this.treatment_id),this.doctor_id&&(t+=(t?"&":"")+"doctor="+this.doctor_id),this.symptom_id&&(t+=(t?"&":"")+"symptom="+this.symptom_id),this.analysis_id&&(t+=(t?"&":"")+"analysis="+this.analysis_id),this.clinic_id&&(t+=(t?"&":"")+"clinic="+this.clinic_id),t}static{this.\u0275fac=function(s){return new(s||o)(n(I),n(x),n(j),n(D),n(M),n(R),n(T))}}static{this.\u0275cmp=w({type:o,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Records",3,"columns","config","rows"]],template:function(s,i){s&1&&F(0,"wtable",0),s&2&&S("columns",i.columns)("config",i.config)("rows",i.rows)},dependencies:[q],encapsulation:2})}}return o})();var U=[{path:"",component:r},{path:":patient_id",component:r},{path:":patient_id/diseases/:disease_id",component:r},{path:":patient_id/treatment/:treatment_id",component:r},{path:":patient_id/doctors/:doctor_id",component:r},{path:":patient_id/symptoms/:symptom_id",component:r},{path:":patient_id/analysis/:analysis_id",component:r},{path:":clinics/:clinic_id",component:r}],$=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=b({type:o})}static{this.\u0275inj=C({imports:[k.forChild(U),P]})}}return o})();export{$ as RecordsModule};
